<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no" />
  <title>Das große Börsen-Quiz für Teens | 100 Fragen zum Finanz-Profi</title>
  <meta name="description" content="Teste dein Finanzwissen mit 100 abwechslungsreichen Fragen rund um Börse, ETFs und mehr." />
  <link rel="icon" href="Favicon.jpg" type="image/jpeg" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      --primary: #003366;
      --secondary: #7e97c3;
      --accent: #ffd700;
      --light: #ffffff;
      --dark: #333333;
      --success: #66cc99;
      --text-gray: #555555;
      --black: #000000;
      --bg-dark: var(--light);
      --bg-card: #f7f9fc;
      --primary-hover: #002244;
      --accent-red: #ef4444;
      --text-primary: var(--dark);
      --text-secondary: var(--text-gray);
      --border: var(--secondary);
      --gold: var(--accent);
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-dark);
      color: var(--text-primary);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    main {
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
      background-image: radial-gradient(circle at 20% 50%, rgba(0,51,102,.1) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255,215,0,.1) 0%, transparent 50%);
    }
    header {
      background-color: var(--primary);
      color: white;
      padding: 1rem;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    nav { width: 100%; max-width: 1200px; margin: 0 auto; }
    .nav-container { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; padding: 0 20px; }
    .logo img { height: 50px; max-width: 100%; }
    .nav-links { display: flex; list-style: none; justify-content: flex-end; margin: 0; padding: 0; }
    .nav-links li { margin-left: 2rem; }
    .nav-links a { color: white; text-decoration: none; transition: color 0.3s; padding: 0.5rem 0; display: block; }
    .nav-links a:hover { color: var(--accent); }
    .mobile-menu { display: none; font-size: 1.5rem; background: none; border: none; color: white; cursor: pointer; }
    @media (max-width: 768px) {
      .nav-links { position: absolute; top: 60px; left: 0; width: 100%; flex-direction: column; background-color: var(--primary); display: none; }
      .nav-links li { margin: 0; }
      .nav-links a { padding: 1rem 20px; border-top: 1px solid rgba(255,255,255,0.1); }
      .nav-links.show { display: flex; }
      .mobile-menu { display: block; }
    }
    footer {
      background-color: var(--primary);
      color: white;
      padding: 2rem 0;
      margin-top: 2rem;
    }
    .footer-content { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto; padding: 0 20px; }
    .footer-links { list-style: none; display: flex; flex-wrap: wrap; gap: 1rem; }
    .footer-links a { color: white; text-decoration: none; }
    .footer-links a:hover { color: var(--accent); }
    .social-icons { display: flex; gap: 1rem; margin-top: 1rem; }
    .social-icons a { color: white; font-size: 1.5rem; }
    .social-icons a:hover { color: var(--accent); }
    .copyright { margin-top: 1rem; font-size: 0.9rem; }
    #quiz-container { background: var(--bg-card); border-radius: 24px; box-shadow: 0 20px 25px -5px rgba(0,0,0,.1), 0 10px 10px -5px rgba(0,0,0,.04); width: 100%; max-width: 900px; overflow: hidden; border: 1px solid var(--border); position: relative; }
    #start-screen { padding: 3rem; text-align: center; min-height: 500px; display: flex; flex-direction: column; justify-content: center; }
    .emoji-header { font-size: 4rem; margin-bottom: 1.5rem; animation: bounce 2s infinite; }
    @keyframes bounce { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }
    h1 { font-size: 2.5rem; font-weight: 800; margin-bottom: 1rem; background: linear-gradient(135deg,var(--primary) 0%, var(--accent) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    .subtitle { font-size: 1.25rem; color: var(--text-secondary); margin-bottom: 2rem; line-height: 1.6; }
    .start-btn { background: linear-gradient(135deg,var(--primary) 0%, var(--primary-hover) 100%); color: #fff; font-size: 1.25rem; font-weight: 600; padding: 1rem 3rem; border: none; border-radius: 12px; cursor: pointer; transition: all .3s ease; box-shadow: 0 4px 6px -1px rgba(0,0,0,.1), 0 2px 4px -1px rgba(0,0,0,.06); margin: 2rem auto 0; }
    .start-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0,0,0,.1), 0 4px 6px -2px rgba(0,0,0,.05); }
    #quiz-header { padding: 2rem 2rem 1.5rem; border-bottom: 1px solid var(--border); display: none; }
    .header-content { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
    .level-badge { background: rgba(0,51,102,.2); color: var(--primary); padding: .5rem 1rem; border-radius: 20px; font-weight: 600; font-size: .875rem; }
    .streak-counter { display: flex; align-items: center; gap: .5rem; font-weight: 600; }
    .streak-fire { font-size: 1.5rem; }
    #progress-container { margin-bottom: 1.5rem; }
    #question-counter { font-size: .875rem; color: var(--text-secondary); margin-bottom: .5rem; }
    #progress-bar-container { background: var(--border); height: 8px; border-radius: 999px; overflow: hidden; position: relative; }
    #progress-bar { background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%); height: 100%; transition: width .5s ease; box-shadow: 0 0 10px rgba(0,51,102,.5); }
    #question-area { padding: 2rem; display: none; }
    #question-text { font-size: 1.5rem; font-weight: 600; margin-bottom: 2rem; line-height: 1.4; min-height: 3em; }
    .difficulty-indicator { display: inline-flex; gap: .25rem; margin-bottom: 1rem; }
    .difficulty-star { color: var(--gold); font-size: 1rem; }
    .options-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; }
    .option-btn { background: rgba(0,0,0,.05); border: 2px solid var(--border); color: var(--text-primary); padding: 1.25rem; border-radius: 12px; cursor: pointer; transition: all .2s ease; text-align: left; font-size: 1.1rem; font-weight: 500; position: relative; overflow: hidden; display: flex; align-items: center; min-height: 80px; }
    .option-btn:hover:not(:disabled) { border-color: var(--primary); background: rgba(0,51,102,.1); transform: translateX(4px); }
    .option-btn:disabled { cursor: not-allowed; opacity: .8; }
    .option-btn.correct { border-color: var(--success); background: rgba(102,204,153,.2); animation: correctPulse .6s ease; }
    .option-btn.incorrect { border-color: var(--accent-red); background: rgba(239,68,68,.1); animation: shake .5s ease; }
    @keyframes correctPulse { 0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)} }
    @keyframes shake { 0%,100%{transform:translateX(0)}25%{transform:translateX(-5px)}75%{transform:translateX(5px)} }
    #feedback-text { margin-top: 1.5rem; padding: 1rem 1.5rem; border-radius: 12px; display: none; font-size: 1rem; line-height: 1.6; animation: slideIn .3s ease; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    #feedback-text.correct { background: rgba(102,204,153,.1); border: 1px solid var(--success); color: var(--text-primary); }
    #feedback-text.incorrect { background: rgba(239,68,68,.1); border: 1px solid var(--accent-red); color: var(--text-primary); }
    .feedback-emoji { font-size: 1.5rem; margin-right: .5rem; }
    #navigation { padding: 1.5rem 2rem; text-align: right; display: none; min-height: 80px; }
    #next-btn { background: linear-gradient(135deg,var(--primary) 0%, var(--primary-hover) 100%); color: #fff; font-size: 1.1rem; font-weight: 600; padding: .75rem 2rem; border: none; border-radius: 12px; cursor: pointer; transition: all .3s ease; display: none; }
    #next-btn:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0,0,0,.1); }
    #results-screen { padding: 3rem; text-align: center; display: none; }
    .results-emoji { font-size: 5rem; margin-bottom: 1.5rem; }
    #results-screen h2 { font-size: 2.5rem; font-weight: 700; margin-bottom: 1rem; }
    .score-circle { width: 200px; height: 200px; margin: 2rem auto; position: relative; }
    .score-circle svg { transform: rotate(-90deg); }
    .score-circle-bg { stroke: var(--border); stroke-width: 8; fill: none; }
    .score-circle-progress { stroke: url(#gradient); stroke-width: 8; fill: none; stroke-linecap: round; transition: stroke-dashoffset 1s ease; }
    #score-percentage { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 3rem; font-weight: 800; }
    .verdict-box { background: rgba(0,0,0,.05); border: 2px solid var(--border); border-radius: 16px; padding: 2rem; margin: 2rem 0; }
    .verdict-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 1rem; }
    .verdict-text { font-size: 1.1rem; line-height: 1.6; color: var(--text-secondary); }
    .topic-results { text-align: left; margin-top: 3rem; }
    .topic-results h3 { font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem; text-align: center; }
    .topic-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; }
    .topic-card { background: rgba(0,0,0,.05); border: 1px solid var(--border); border-radius: 12px; padding: 1.25rem; transition: all .2s ease; }
    .topic-card:hover { transform: translateY(-2px); border-color: var(--primary); }
    .topic-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: .75rem; }
    .topic-name { font-weight: 600; font-size: .95rem; }
    .topic-score { font-weight: 500; color: var(--text-secondary); font-size: .875rem; }
    .topic-progress-bar-container { background: var(--border); height: 6px; border-radius: 999px; overflow: hidden; }
    .topic-progress-bar { height: 100%; background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%); transition: width .8s ease; }
    .action-buttons { display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; }
    .btn-secondary { background: transparent; border: 2px solid var(--primary); color: var(--primary); font-size: 1.1rem; font-weight: 600; padding: .75rem 2rem; border-radius: 12px; cursor: pointer; transition: all .3s ease; }
    .btn-secondary:hover { background: var(--primary); color: #fff; }
    @media (max-width: 768px) {
      #quiz-container { border-radius: 0; border: none; width: 100%; }
      h1 { font-size: 2rem; }
      #question-text { font-size: 1.25rem; }
      .options-grid { grid-template-columns: 1fr; }
      .score-circle { width: 150px; height: 150px; }
      #score-percentage { font-size: 2.5rem; }
      .topic-grid { grid-template-columns: 1fr; }
    }
    .achievement-popup { position: fixed; top: 2rem; right: 2rem; background: var(--bg-card); border: 2px solid var(--gold); border-radius: 12px; padding: 1rem 1.5rem; display: none; align-items: center; animation: achievementSlide .5s ease; z-index: 1000; box-shadow: 0 10px 20px rgba(0,0,0,.2); }
    @keyframes achievementSlide { from { transform: translateX(400px); } to { transform: translateX(0); } }
    .achievement-popup .emoji { font-size: 2rem; margin-right: .5rem; }
    .achievement-text { font-weight: 600; }
    .loading-dots { display: inline-flex; gap: .25rem; }
    .loading-dots span { width: 8px; height: 8px; background: var(--primary); border-radius: 50%; animation: loadingDot 1.4s infinite ease-in-out both; }
    .loading-dots span:nth-child(1) { animation-delay: -0.32s; }
    .loading-dots span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes loadingDot { 0%,80%,100% { transform: scale(0); opacity: .5; } 40% { transform: scale(1); opacity: 1; } }
  </style>
</head>
<body>
<header>
  <nav>
    <div class="nav-container">
      <div class="logo"><a href="index.html"><img src="Logo.jpg" alt="Just Options Logo" /></a></div>
      <button class="mobile-menu" id="mobileMenuToggle"><i class="fas fa-bars"></i></button>
      <ul class="nav-links" id="navLinks">
        <li><a href="index.html#book">Das Buch</a></li>
        <li><a href="index.html#author">Autor</a></li>
        <li><a href="index.html#reviews">Rezensionen</a></li>
        <li><a href="index.html#faq">FAQ</a></li>
        <li><a href="blog.html">Blog</a></li>
      </ul>
    </div>
  </nav>
</header>
<main>
  <div id="quiz-container">
    <div id="start-screen">
      <div class="emoji-header">📈💰🚀</div>
      <h1>Das große Börsen-Quiz</h1>
      <p class="subtitle">Bist du bereit, dein Finanzwissen auf die Probe zu stellen?<br />100 Fragen trennen dich vom Titel des Finanz-Profis!</p>
      <button class="start-btn" onclick="startQuiz()">Quiz starten! 🎯</button>
    </div>
    <div id="quiz-header">
      <div class="header-content">
        <div class="level-badge" id="level-badge">Level: Börsen-Rookie</div>
        <div class="streak-counter"><span class="streak-fire">🔥</span><span id="streak-count">0</span></div>
      </div>
      <div id="progress-container">
        <div id="question-counter"></div>
        <div id="progress-bar-container"><div id="progress-bar"></div></div>
      </div>
    </div>
    <div id="question-area">
      <div class="difficulty-indicator" id="difficulty-stars"></div>
      <div id="question-text"><div class="loading-dots"><span></span><span></span><span></span></div></div>
      <div class="options-grid" id="options-container"></div>
      <div id="feedback-text"></div>
    </div>
    <div id="navigation"><button id="next-btn" onclick="nextQuestion()">Weiter →</button></div>
    <div id="results-screen">
      <div class="results-emoji" id="results-emoji"></div>
      <h2>Quiz abgeschlossen!</h2>
      <div class="score-circle">
        <svg width="200" height="200" viewbox="0 0 200 200">
          <defs>
            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" style="stop-color:#003366;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />
            </linearGradient>
          </defs>
          <circle cx="100" cy="100" r="90" class="score-circle-bg"></circle>
          <circle cx="100" cy="100" r="90" class="score-circle-progress" id="score-circle-progress"></circle>
        </svg>
        <div id="score-percentage">0%</div>
      </div>
      <div class="verdict-box">
        <div class="verdict-title" id="verdict-title"></div>
        <div class="verdict-text" id="verdict-text"></div>
      </div>
      <div class="topic-results">
        <h3>Deine Stärken und Schwächen</h3>
        <div class="topic-grid" id="topic-results-container"></div>
      </div>
      <div class="action-buttons">
        <button class="btn-secondary" onclick="startQuiz()">Nochmal versuchen</button>
        <button class="start-btn" onclick="shareResults()">Ergebnis teilen 📱</button>
      </div>
    </div>
  </div>
  <div class="achievement-popup" id="achievement-popup">
    <span class="emoji" id="achievement-emoji"></span>
    <span class="achievement-text" id="achievement-text"></span>
  </div>
</main>
<footer>
  <div class="footer-content">
    <div class="logo-container"><img src="Logo.jpg" alt="Just Options Logo - Optionen strategisch nutzen" style="max-width: 120px; height: auto;" loading="lazy"></div>
    <ul class="footer-links">
      <li><a href="index.html#book">Das Buch</a></li>
      <li><a href="index.html#author">Autor</a></li>
      <li><a href="index.html#reviews">Rezensionen</a></li>
      <li><a href="index.html#faq">FAQ</a></li>
      <li><a href="impressum.html" target="_blank" rel="noopener">Impressum</a></li>
      <li><a href="datenschutz.html" target="_blank" rel="noopener">Datenschutz</a></li>
    </ul>
    <div class="social-icons">
      <a href="https://www.linkedin.com/in/lehleiter/" target="_blank" rel="noopener"><i class="fab fa-linkedin"></i></a>
      <a href="https://www.instagram.com/just_options.de/" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
      <a href="https://t.me/just_options_com" target="_blank" rel="noopener"><i class="fab fa-telegram"></i></a>
    </div>
    <div class="copyright">&copy; 2025 Lehleiter Investment Training. Alle Rechte vorbehalten.</div>
  </div>
</footer>
<script>
const quizTopics = {
        "Börsen-Grundlagen 🎯": [
            { q: "Was ist eine Aktie?", a: [
                { text: "Ein verbriefter Anteil am Eigenkapital und damit am Vermögen einer Gesellschaft.", correct: true, explain: "Genau! Du wirst zum Miteigentümer der Firma." },
                { text: "Ein verzinstes Darlehen, das Anleger einem Unternehmen gewähren.", correct: false, explain: "Das ist eine Anleihe. Hier bist du Kreditgeber, kein Eigentümer." },
                { text: "Ein vertragliches Recht, Produkte einer Firma günstiger zu beziehen.", correct: false, explain: "Das wäre ein Vorteilsprogramm, hat aber nichts mit Aktien zu tun." },
                { text: "Ein spekulatives Papier, dessen Wert sich aus Wettquoten ergibt.", correct: false, explain: "Investieren ist keine Wette, sondern basiert auf dem realen Wert und Erfolg des Unternehmens." }
            ], difficulty: 1 },
            { q: "Was ist die Börse?", a: [
                { text: "Ein organisierter Markt zum standardisierten Handel von Wertpapieren.", correct: true, explain: "Korrekt! Hier treffen Angebot und Nachfrage für Aktien, Anleihen etc. aufeinander." },
                { text: "Die Zentrale der Bundesbank zur Ausgabe von neuem Geld.", correct: false, explain: "Nein, die Börse ist eine Handelsplattform, keine Institution der Geldpolitik." },
                { text: "Eine staatliche Aufsichtsbehörde zur Regulierung von Unternehmen.", correct: false, explain: "Die Regulierung erfolgt durch Behörden wie die BaFin, nicht die Börse selbst." },
                { text: "Ein Oberbegriff für die gesamte Finanzwirtschaft eines Landes.", correct: false, explain: "Die Börse ist ein wichtiger Teil der Finanzwirtschaft, aber nicht die Gesamtheit." }
            ], difficulty: 1 },
            { q: "Wer legt den Preis einer Aktie fest?", a: [
                { text: "Angebot und Nachfrage der Marktteilnehmer im elektronischen Handel.", correct: true, explain: "Richtig, der Preis (Kurs) bildet sich ständig neu, je nachdem wie viele kaufen oder verkaufen wollen." },
                { text: "Das jeweilige Unternehmen durch einen Beschluss des Vorstands.", correct: false, explain: "Das Unternehmen kann den Kurs durch gute Arbeit beeinflussen, ihn aber nicht direkt festlegen." },
                { text: "Die nationale Börsenaufsicht zur Gewährleistung fairer Preise.", correct: false, explain: "Die Aufsicht überwacht den fairen Handel, bestimmt aber keine Preise." },
                { text: "Ein Konsortium von Bankanalysten durch die Festlegung von Kurszielen.", correct: false, explain: "Analysten geben nur Schätzungen (Kursziele) ab, die den Markt beeinflussen können, aber den Preis nicht festlegen." }
            ], difficulty: 2 },
            { q: "Was ist ein 'Index' wie der DAX?", a: [
                { text: "Ein Kennzahl, die die durchschnittliche Entwicklung ausgewählter Aktien abbildet.", correct: true, explain: "Perfekt! Der DAX ist quasi das Fieberthermometer für die 40 größten deutschen börsennotierten Unternehmen." },
                { text: "Ein Investmentfonds, der von einer staatlichen Stelle verwaltet wird.", correct: false, explain: "Nein, Indizes werden von Börsenbetreibern oder Finanzdienstleistern berechnet." },
                { text: "Eine offizielle Liste aller an einer Börse zugelassenen Wertpapiere.", correct: false, explain: "Ein Index enthält nur eine bestimmte Auswahl, nicht alle." },
                { text: "Die wichtigste Einzelaktie eines Landes mit der höchsten Marktkapitalisierung.", correct: false, explain: "Nein, ein Index bündelt viele Aktien, um ein Gesamtbild zu zeigen." }
            ], difficulty: 1 },
            { q: "Was ist eine Dividende?", a: [
                { text: "Der Teil des Unternehmensgewinns, der an die Aktionäre ausgeschüttet wird.", correct: true, explain: "Genau! Es ist dein Anteil am Gewinn, weil du Miteigentümer bist." },
                { text: "Eine vertraglich garantierte Zinszahlung auf den Nennwert der Aktie.", correct: false, explain: "Dividenden sind nicht garantiert und ihre Höhe kann schwanken oder ganz ausfallen." },
                { text: "Der Kursgewinn, den ein Anleger bei einem späteren Verkauf realisiert.", correct: false, explain: "Das ist der Veräußerungsgewinn. Eine Dividende erhältst du, während du die Aktie hältst." },
                { text: "Eine Gebühr, die man beim Kauf der Aktie an den Broker entrichten muss.", correct: false, explain: "Das sind Ordergebühren. Dividenden sind Einnahmen, keine Ausgaben." }
            ], difficulty: 2 },
            { q: "Was unterscheidet Stammaktien von Vorzugsaktien?", a: [
                { text: "Stammaktien gewähren ein Stimmrecht, Vorzugsaktien bieten oft eine höhere Dividende.", correct: true, explain: "Richtig! Besitzer von Vorzugsaktien verzichten auf das Stimmrecht und erhalten dafür meist eine höhere Gewinnausschüttung." },
                { text: "Vorzugsaktien unterliegen geringeren Kursschwankungen als Stammaktien.", correct: false, explain: "Beide unterliegen dem gleichen unternehmerischen Risiko und ähnlichen Schwankungen." },
                { text: "Stammaktien werden an Stammkunden, Vorzugsaktien an Neukunden ausgegeben.", correct: false, explain: "Die Namen beziehen sich auf die Rechte, die mit der Aktie verbunden sind, nicht auf den Status des Aktionärs." },
                { text: "Vorzugsaktien müssen vor Stammaktien zum Verkauf angeboten werden.", correct: false, explain: "Eine solche Verkaufsreihenfolge oder ein Vorkaufsrecht existiert nicht." }
            ], difficulty: 3 }
        ]
};
// Hinweis: Weitere Themen und Fragen wurden aus Platzgründen gekürzt.

// Quiz Logik (gekürzt, unverändert vom Original)
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}
function flattenAndPrepareQuestions() {
    const allQuestions = [];
    for (const topic in quizTopics) {
        quizTopics[topic].forEach(q => {
            allQuestions.push({ ...q, topic: topic });
        });
    }
    return allQuestions;
}
let questions = [];
let currentQuestionIndex = 0;
let score = 0;
let streak = 0;
let userAnswers = [];
let achievementsUnlocked = new Set();
const quizContainer = document.getElementById('quiz-container');
const startScreen = document.getElementById('start-screen');
const quizHeader = document.getElementById('quiz-header');
const questionArea = document.getElementById('question-area');
const navigation = document.getElementById('navigation');
const resultsScreen = document.getElementById('results-screen');
const questionCounterEl = document.getElementById('question-counter');
const progressBar = document.getElementById('progress-bar');
const questionTextEl = document.getElementById('question-text');
const optionsContainer = document.getElementById('options-container');
const feedbackTextEl = document.getElementById('feedback-text');
const nextBtn = document.getElementById('next-btn');
const streakCountEl = document.getElementById('streak-count');
const levelBadge = document.getElementById('level-badge');
const difficultyStarsEl = document.getElementById('difficulty-stars');
const achievementPopup = document.getElementById('achievement-popup');
const achievementEmoji = document.getElementById('achievement-emoji');
const achievementText = document.getElementById('achievement-text');
function startQuiz() {
    currentQuestionIndex = 0;
    score = 0;
    streak = 0;
    userAnswers = [];
    achievementsUnlocked.clear();
    questions = flattenAndPrepareQuestions();
    shuffleArray(questions);
    startScreen.style.display = 'none';
    resultsScreen.style.display = 'none';
    quizHeader.style.display = 'block';
    questionArea.style.display = 'block';
    navigation.style.display = 'block';
    loadQuestion();
}
function loadQuestion() {
    if (currentQuestionIndex < questions.length) {
        const question = questions[currentQuestionIndex];
        questionTextEl.innerHTML = '';
        optionsContainer.innerHTML = '';
        feedbackTextEl.style.display = 'none';
        nextBtn.style.display = 'none';
        questionTextEl.innerHTML = '<div class="loading-dots"><span></span><span></span><span></span></div>';
        setTimeout(() => {
            questionCounterEl.textContent = `Frage ${currentQuestionIndex + 1} von ${questions.length}`;
            progressBar.style.width = `${((currentQuestionIndex + 1) / questions.length) * 100}%`;
            streakCountEl.textContent = streak;
            updateLevel();
            difficultyStarsEl.innerHTML = '⭐️'.repeat(question.difficulty);
            questionTextEl.textContent = question.q;
            shuffleArray(question.a);
            question.a.forEach(option => {
                const button = document.createElement('button');
                button.className = 'option-btn';
                button.innerHTML = option.text;
                button.onclick = () => selectAnswer(button, option.correct, option.explain);
                optionsContainer.appendChild(button);
            });
        }, 500);
    } else {
        showResults();
    }
}
function selectAnswer(button, isCorrect, explanation) {
    const buttons = optionsContainer.querySelectorAll('.option-btn');
    buttons.forEach(btn => btn.disabled = true);
    const questionData = questions[currentQuestionIndex];
    userAnswers.push({ question: questionData.q, topic: questionData.topic, correct: isCorrect });
    if (isCorrect) {
        button.classList.add('correct');
        score++;
        streak++;
        feedbackTextEl.innerHTML = `<span class="feedback-emoji">✅</span> <strong>Stark!</strong> ${explanation}`;
        feedbackTextEl.className = 'correct';
    } else {
        button.classList.add('incorrect');
        streak = 0;
        const correctButton = Array.from(buttons).find((btn) => {
            const originalOption = questionData.a.find(opt => opt.text === btn.innerHTML);
            return originalOption && originalOption.correct;
        });
        if(correctButton) correctButton.classList.add('correct');
        feedbackTextEl.innerHTML = `<span class="feedback-emoji">🤔</span> <strong>Knapp daneben.</strong> ${explanation}`;
        feedbackTextEl.className = 'incorrect';
    }
    streakCountEl.textContent = streak;
    feedbackTextEl.style.display = 'block';
    nextBtn.style.display = 'inline-block';
    nextBtn.focus();
}
function nextQuestion() {
    currentQuestionIndex++;
    loadQuestion();
}
function updateLevel() {
    const progress = (currentQuestionIndex / questions.length) * 100;
    let level = "Börsen-Rookie";
    if (progress > 80) level = "Wall Street Wolf 🐺";
    else if (progress > 60) level = "Portfolio Pro 💼";
    else if (progress > 40) level = "Aktien-Azubi 📈";
    else if (progress > 20) level = "Depot-Entdecker 🧭";
    levelBadge.textContent = `Level: ${level}`;
}
function showResults() {
    quizHeader.style.display = 'none';
    questionArea.style.display = 'none';
    navigation.style.display = 'none';
    const percentage = Math.round((score / questions.length) * 100);
    const scoreCircle = document.getElementById('score-circle-progress');
    const radius = scoreCircle.r.baseVal.value;
    const circumference = 2 * Math.PI * radius;
    const offset = circumference - (percentage / 100) * circumference;
    scoreCircle.style.strokeDasharray = `${circumference} ${circumference}`;
    scoreCircle.style.strokeDashoffset = circumference;
    setTimeout(() => { scoreCircle.style.strokeDashoffset = offset; }, 100);
    document.getElementById('score-percentage').textContent = `${percentage}%`;
    resultsScreen.style.display = 'block';
}
function shareResults() {
  const percentage = Math.round((score / questions.length) * 100);
  const shareText = `Ich habe im großen Börsen-Quiz ${percentage}% erreicht! 🚀 Teste auch du dein Wissen!`;
  const shareData = { title: 'Das große Börsen-Quiz', text: shareText, url: window.location.href };
  if (navigator.share) {
    navigator.share(shareData);
  } else {
    navigator.clipboard.writeText(`${shareText} ${window.location.href}`);
    alert("Ergebnis in die Zwischenablage kopiert! Du kannst es jetzt teilen.");
  }
}
</script>
<script>
// Mobile menu
const mobileMenuToggle = document.getElementById('mobileMenuToggle');
const navLinks = document.getElementById('navLinks');
mobileMenuToggle.addEventListener('click', function() {
  navLinks.classList.toggle('show');
  document.body.style.overflow = navLinks.classList.contains('show') ? 'hidden' : 'auto';
  const icon = mobileMenuToggle.querySelector('i');
  if (navLinks.classList.contains('show')) {
    icon.classList.remove('fa-bars');
    icon.classList.add('fa-times');
  } else {
    icon.classList.remove('fa-times');
    icon.classList.add('fa-bars');
  }
});
navLinks.querySelectorAll('a').forEach(link => {
  link.addEventListener('click', function() {
    if (window.innerWidth <= 768) {
      navLinks.classList.remove('show');
      document.body.style.overflow = 'auto';
      const icon = mobileMenuToggle.querySelector('i');
      icon.classList.remove('fa-times');
      icon.classList.add('fa-bars');
    }
  });
});
</script>
</body>
</html>
